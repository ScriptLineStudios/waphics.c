function _render() { var c = document.getElementById("canvas" ,{"alpha": false}); var ctx = c.getContext("2d"); let pixels = Module.ccall('render', "number", null, null ); var buffer = new Uint8ClampedArray(Module.HEAPU8.buffer, pixels, width*height*channels); var img = new ImageData(buffer, width); ctx.putImageData(img, 0, 0); window.requestAnimationFrame(_render); } Module.onRuntimeInitialized = () => { Module.ccall("init"); window.requestAnimationFrame(_render); }